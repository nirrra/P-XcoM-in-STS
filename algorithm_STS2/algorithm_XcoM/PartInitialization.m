%% 设定参数

g = 9.79;

%% 函数

funcSumXYZ = @(x,y,z) (x.^2+y.^2+z.^2).^0.5;
DivMean = @(a)(a-mean(a));
ScaleData = @(a,b)((a-min(a))./range(a)*range(b)+min(b));
funcDiffAngle = @(a,t) (interp1(t(1:end-1)+diff(t)/2,diff(a)./diff(t),t,'linear','extrap'));

%% 作图

colors = [
    0.35 0.35 0.35;   % 深灰 1
    0.80 0.40 0.40;   % 红褐 2
    0.40 0.60 0.80;   % 蓝灰 3
    0.60 0.70 0.30;   % 橄榄绿 4
    0.45 0.45 0.55;   % 雾霾灰 5
    0.50 0.40 0.60;   % 紫灰 6
    0.75 0.55 0.55;   % 玫瑰石英 7
    0.30 0.50 0.60;   % 深海蓝 8
    0.65 0.75 0.65;   % 薄荷灰 9
    0.85 0.65 0.45;   % 陶土色 10
    0.55 0.65 0.75;   % 冰川蓝 11
    0.70 0.50 0.70;   % 灰紫色 12
    0.25 0.60 0.45;   % 葱绿 13
];

% 垂直线颜色
line_colors = [
    190, 69, 57;      % 开始
    243, 160, 109;    % P1
    62, 100, 55;      % P2
    39, 100, 199;     % P3
    0, 0, 0;          % 结束
    200,200,200;
    160,160,160;
    120,120,120;
    80,80,80;
]./255;

plt.color1 = [248,108,35]/255; plt.color2 = [43,106,153]/255; plt.color3 = [97,177,150]/255;
plt.color4 = [204,22,58]/255; plt.color5 = [18,107,174]/255; plt.color6 = [49,74,67]/255;
plt.color7 = [102,102,102]/255;

plt.color1 = [18,143,100]/255; plt.color2 = [205,76,37]/255; plt.color3 = [18,76,126]/255; plt.color6 = [1,1,1]/255; 
plt.color7 = [102,102,102]/255;

plt.colorB = [0,0,0]/255; plt.colorG = [153,153,153]/255; plt.colorG2 = [204,204,204]/255;
 
lw1 = 2.5; lw2 = 2; lw3 = 1.5;

%% 被试信息

numSub = 3;
ages = 2024-[1994 1998 2001]';
heights = [170 173 188]'./100;
weights = [68 66 98]';
genders = 'MMM';
unitScaling = 1; % 默认压力单位为kg，用以调整阈值
% weightNormal = 60; heightNormal = 170;
weightNormal = 1; heightNormal = 1;

cellNames = {'xsq','wdy','wyc'};

%% 手动选取参数

times_stable_stand = {
[9.3952, 12.2177, 19.5565, 20.3629, 26.8952, 27.7823, 35.0403, 35.3629, 41.0887, 41.4919, 51.5726, 52.5403, 57.7016, 57.9435, 63.2661, 63.6694, 77.9435, 78.1855]
[]
[3.3266, 3.8105, 7.0766, 7.3589, 10.746, 11.1492, 14.9798, 15.4234, 19.0927, 19.4153, 23.3669, 23.7702, 27.7621, 28.125, 32.1976, 32.6008, 36.5524, 37.0766]
[11.2984, 11.7823, 15.7984, 16.3306, 19.9597, 20.2984, 24.2661, 24.7984, 28.5726, 29.0565, 32.879, 33.121, 36.9919, 37.5242, 41.25, 41.4919, 45.3629, 45.5565, 49.379, 49.5726]
[8.5282, 9.0121, 14.0524, 14.4556, 18.125, 18.4476, 21.996, 22.3589, 26.2702, 26.5121, 30.1008, 30.4234, 34.1331, 34.496, 38.1653, 38.5685, 42.2379, 42.6008, 45.9073, 46.1895]
[7.8306, 8.0726, 11.3629, 11.75, 15.2339, 15.5726, 18.9597, 19.2984, 22.7823, 23.0242, 26.9435, 27.1371, 30.5726, 30.8145, 34.2016, 34.5403, 37.9274, 38.2177, 41.8952, 42.4274]
[13.9153, 14.4798, 19.1089, 19.7298, 23.8508, 24.4153, 32.4315, 32.6008, 36.8347, 37.1734, 41.0121, 41.3508, 45.0766, 45.5847, 49.5363, 50.1008, 53.9395, 54.3347, 58.0605, 58.5121]
[]
[5.8306, 6.1694, 10.8629, 11.5403, 16.2339, 16.7177, 21.5081, 22.0403, 27.2661, 27.8468, 32.4919, 33.0242, 37.621, 38.2984, 42.5565, 42.8952, 47.3468, 47.5887]
[6.5484, 7.0645, 12.4839, 13, 17.3226, 17.9032, 22.0968, 22.5484, 27.0645, 27.4516, 32.0968, 32.2903, 36.4194, 36.6774, 40.6129, 40.8065, 44.9355, 45.1935, 49.6452, 49.8387, 53.9032, 54.2903, 58.6129, 58.8065]
% 11
[14.8065, 15.5161, 19.9677, 20.1613, 25.129, 25.4516, 30.2258, 30.7419, 36.3548, 36.6129, 41.4516, 41.7742, 46.0968, 46.2903, 50.871, 51.0645, 55.2581, 55.4516, 59.4516, 59.7097]
[3.5766, 4.3669, 9.8427, 10.1815, 14.9798, 15.2056, 19.8911, 20.1734, 24.2944, 24.746, 28.6976, 29.0363, 33.3266, 33.7782, 37.8427, 38.3508, 42.6976, 42.8669, 47.1573, 47.4395]
[11.4113, 11.7984, 16.4919, 16.8306, 20.6048, 20.8468, 25.0081, 25.25, 29.6048, 29.8468, 34.2016, 34.7823, 38.5081, 38.7984, 43.1048, 43.4919]
[3.4476, 4.2944, 8.5282, 9.4153, 13.3669, 13.9718, 17.4798, 18.1653, 25.1411, 25.3427, 37.6815, 37.8831, 41.9556, 42.1573]
[1.496, 2.7944, 9.0605, 9.5685, 14.254, 14.5927, 18.5444, 18.8831, 22.8911, 23.0605, 27.3508, 27.8024, 32.2621, 32.7137, 37.1734, 37.3427]
[11.1532, 11.6371, 15.6048, 16.1371, 20.1048, 20.5403, 24.4597, 25.1371, 28.6694, 29.2016, 32.6855, 32.9274, 44.4919, 44.6371, 52.1371, 52.4758]
[11.3105, 11.5524, 15.4637, 15.8266, 19.2944, 19.9395, 23.2863, 23.6492, 27.1169, 27.3992, 31.0282, 31.4315, 34.8589, 35.1411, 38.5685, 38.9718]
[1.7742, 2.871, 7.9677, 8.2903, 16.4839, 16.6129, 20.2258, 20.6129, 28.7419, 29.0645, 33, 33.3226, 37.2581, 37.6452, 41.3871, 41.9032, 45.9677, 46.4194, 50.6129, 51, 55.129, 55.3871]
[9.129, 10.6774, 24.2258, 24.3548, 28.1613, 28.4194, 36.0323, 36.2258, 40.1613, 40.6774, 44.6129, 45, 49.5161, 50.2258, 54.1613, 54.6774]
[13.0192, 13.6542, 92.8579, 93.2208, 104.2893, 104.9244]
% 21
[6.6129, 7.7742, 14.4839, 15.1935, 20.2903, 20.7419, 26.0968, 26.4194, 31.5806, 32.2903, 37.3226, 37.5806, 43, 43.2581, 48.871, 49.2581, 60.3548, 60.871]
[2.8226, 3.629, 10.2419, 10.5645, 16.371, 16.8548, 27.5, 28.1452, 43.9516, 44.4355, 64.7581, 65.2419, 85.7258, 86.0484, 101.5323, 102.0161, 122.3387, 122.5, 131.371, 131.6935, 150.7258, 151.0484]
[1.8265, 2.7397, 10.6545, 11.1111, 16.7428, 17.3516, 22.9833, 23.1355, 47.1842, 47.4886, 76.1035, 76.4079, 112.1766, 112.6332, 147.032, 147.4886, 164.5358, 164.9924, 199.3912, 200]
[14.7641, 15.5758, 31.5068, 32.1157, 37.6966, 38.204, 59.5129, 60.1218, 77.0675, 77.3719, 103.8559, 104.1603, 120.3957, 120.9031, 136.8341, 137.037, 152.1563, 152.6636, 173.5667, 174.0741]
[8.9041, 9.1781, 13.653, 14.1096, 23.9726, 24.5205, 40.5936, 41.3242, 56.5753, 57.6712, 79.2237, 79.7717, 101.9635, 102.2374, 115.6621, 115.9361, 138.3105, 139.0411, 153.379, 153.9269]
[7.1689, 7.6256, 26.4384, 26.7123, 47.6256, 47.9909, 71.5525, 72.0091, 80.137, 80.6849, 97.5799, 97.9452, 114.6575, 114.9315, 139.4064, 139.9543, 152.5571, 152.9224]
[0.59361, 2.7499, 13.658, 14.0893, 17.8691, 18.2496, 21.3191, 21.5728, 24.9975, 25.4033, 28.3714, 28.6758, 32.0244, 32.3541, 35.449, 35.8295]
[1.0198, 1.5982, 7.7169, 7.8691, 13.7443, 14.14, 19.7717, 20.1979, 26.4992, 26.5906, 32.5875, 33.0441, 39.2237, 39.376, 45.4642, 45.8295, 51.583, 52.0091]
[1.0477, 1.758, 6.8366, 7.1918, 13.3359, 13.7976, 19.6575, 19.9772, 26.3343, 26.583, 33.1177, 33.3663, 40.1497, 40.4338, 46.9685, 47.3592, 54.0715, 54.2846, 60.6773, 60.9614]
[3.8204, 6.4181, 18.2293, 18.6352, 48.6707, 50.8625]
% 31
[3.9827, 7.1487, 14.7793, 15.2664, 22.7347, 22.9782, 33.3283, 33.5312, 45.586, 46.3572, 57.5596, 57.9655]
};


times_stss = {
[5.3119, 10.49, 16.5311, 20.1064, 23.8051, 27.4215, 31.6544, 34.901, 38.3941, 41.1064, 44.4352, 46.6133, 49.4078, 52.0379, 55.2023, 57.8325, 61.1612, 63.4626, 66.2982, 68.5174, 71.0242, 73.3667, 75.9147, 78.216]
[]
[1.2363, 3.5351, 5.2748, 7.1595, 9.0441, 11.1358, 13.0619, 15.195, 17.2247, 19.275, 21.4496, 23.562, 25.633, 27.9112, 30.2307, 32.4053, 34.5385, 36.7545]
[9.19, 11.5598, 13.798, 16.0889, 18.1954, 20.1703, 22.2769, 24.5151, 26.727, 28.7282, 30.9664, 32.9149, 35.1005, 37.286, 39.4189, 41.4728, 43.5003, 45.5015, 47.5291, 49.4513]
[6.0351, 8.7452, 11.7816, 14.1906, 16.3737, 18.2307, 20.2633, 22.1202, 24.3787, 26.3611, 28.3435, 30.2506, 32.3334, 34.366, 36.499, 38.4814, 40.4388, 42.371, 44.3283, 46.1853]
[5.8256, 7.9522, 9.6232, 11.6232, 13.5473, 15.3448, 17.2689, 19.0411, 21.0665, 22.9146, 24.9906, 26.9401, 28.8895, 30.7123, 32.5351, 34.3073, 36.2821, 38.1302, 40.1556, 42.1556]
[6.9338, 8.8236, 11.6908, 14.2322, 17.0995, 19.2825, 22.0194, 24.0721, 26.5158, 28.4056, 30.3931, 32.4132, 34.9873, 37.0725, 39.1904, 41.0802, 43.4587, 45.4136, 47.6944, 49.9426, 52.0605, 53.9828, 56.2962, 58.2511]
[]
[3.6775, 6.1981, 8.6903, 11.0975, 14.0146, 16.4785, 19.4238, 21.6611, 25.0313, 27.6085, 30.4405, 32.6779, 35.4816, 37.8889, 40.6077, 42.8733, 45.2522, 47.4329, 49.7269, 51.7377]
[4.2379, 6.8201, 10.2416, 12.6302, 15.4706, 17.6333, 19.9896, 22.4104, 24.9927, 27.3167, 30.028, 32.2229, 34.4824, 36.4191, 38.5817, 40.5507, 42.9393, 45.1019, 47.5873, 49.6531, 51.8803, 54.1075, 56.4637, 58.6587]
% 11
[7.6858, 10.08, 12.6891, 15.0219, 17.9072, 20.148, 23.0026, 25.2741, 28.0366, 30.5229, 34.2063, 36.5085, 39.2096, 41.5425, 44.0595, 46.2388, 48.7251, 50.751, 53.2066, 55.4166, 57.4425, 59.5912]
[7.6836, 10.084, 12.8351, 15.1276, 17.7438, 20.0094, 22.167, 24.3517, 26.7791, 28.9907, 31.3912, 33.5758, 35.8414, 38.107, 40.3995, 42.6111, 45.0385, 47.4659]
[9.2874, 11.607, 14.2009, 16.6203, 18.6655, 20.7357, 23.0802, 25.275, 27.4699, 29.6648, 32.0592, 34.4037, 36.5985, 38.7934, 41.0631, 43.3827, 45.4528, 47.4232]
[1.449, 3.9259, 6.6505, 8.9045, 11.3814, 13.5611, 15.7903, 17.8462, 23.2211, 25.2274, 27.8777, 29.6858, 31.8407, 33.7727, 35.8038, 37.6863, 40.1384, 42.0704, 44.2006, 45.9592]
[6.9658, 9.2986, 12.2453, 14.394, 16.7882, 18.8755, 21.1469, 23.05, 25.5056, 27.6543, 30.294, 32.6575, 35.0518, 37.0776, 39.2877, 41.1908, 43.1246, 44.9356, 46.808, 48.7111, 50.4914, 52.241, 54.2362, 55.9858]
[9.1686, 11.3523, 13.8052, 15.7496, 17.9632, 20.1768, 22.6896, 24.7536, 26.9373, 28.8219, 30.8859, 32.8303, 35.014, 36.5995, 38.9327, 40.6977, 42.7916, 44.5565, 46.5308, 48.206, 50.3598, 52.2144, 54.3383, 56.2528]
[9.5152, 11.48, 13.7222, 15.6176, 17.7442, 19.6397, 21.6738, 23.3843, 25.4185, 27.3601, 29.1631, 30.9892, 33.0696, 35.0113, 36.7911, 38.571, 40.7438, 42.4543]
[6.1113, 8.105, 10.7841, 12.5909, 14.7715, 16.516, 18.5408, 20.4411, 22.684, 24.7712, 26.9206, 29.1013, 31.095, 33.1821, 35.3628, 37.4811, 39.7551, 41.6242, 43.9606, 46.1101, 48.5399, 50.7517, 53.2127, 55.331]
[14.5508, 16.5552, 18.8505, 20.6286, 22.439, 24.2494, 26.4801, 28.3552, 30.3272, 32.0406, 34.142, 36.2757, 38.4094, 40.4138, 42.8708, 44.6165, 47.5584, 49.6275, 52.3754, 54.4768, 56.5458, 58.3886]
[11.1014, 13.2973, 16.0625, 18.1771, 20.861, 23.2195, 26.4727, 28.5872, 31.1898, 33.3857, 36.3949, 38.5907, 41.0306, 43.4705, 45.9104, 48.2689, 50.7088, 52.8234, 54.6939, 56.7272, 59.0044, 60.631, 62.9895, 65.1854, 67.544, 69.3332, 71.5291, 73.481, 75.6769, 77.8728, 79.9873, 82.1832, 85.1924, 87.307, 90.3975, 92.9187, 96.4159, 98.6117, 101.7836, 104.0608, 107.314, 109.8352, 112.3564, 114.6336, 117.3988, 119.7574, 122.4412, 124.4745, 127.565, 129.8422, 132.5261, 134.5593, 137.4058, 139.439, 142.1229, 144.5628, 147.328, 149.5239, 152.3704, 154.8103]
% 21
[4.0961, 7.2504, 12.1617, 14.8369, 17.8715, 20.5468, 23.8609, 26.2966, 29.6107, 31.9665, 35.0809, 37.3968, 40.5113, 43.0667, 46.5405, 48.9363, 52.2903, 54.5663, 57.8804, 60.4758, 63.9895, 66.3054, 69.4598, 72.8537]
[8.0941, 10.553, 13.8597, 16.6578, 19.8798, 22.4235, 25.3911, 27.7652, 30.5633, 33.2765, 36.2442, 38.703, 41.7555, 44.1296, 47.182, 49.4713, 52.1846, 54.7283, 57.2719, 59.7308, 62.4441, 64.9878, 67.701, 70.4143, 73.0428, 75.5017, 78.3845, 80.6738, 83.6415, 86.0156, 88.5592, 91.0181, 93.9858, 96.8686, 99.5819, 102.0408, 105.0084, 107.2129, 110.1806, 112.4699, 115.3527, 117.642, 120.2705, 122.3902, 124.4252, 126.8841, 129.2582, 131.7171, 134.176, 136.4653, 138.9242, 141.7222, 143.7572, 146.2161, 148.3358, 150.7947, 153.3384, 155.5429, 157.8322, 160.4607]
[8.084, 10.7224, 14.5079, 17.1463, 20.3583, 23.2261, 26.5528, 29.0765, 32.862, 35.3857, 38.9418, 41.4655, 44.5628, 47.5453, 50.6426, 53.281, 55.8047, 58.6725, 62.1139, 64.6376, 68.079, 70.6027, 73.7, 76.3384, 79.6651, 82.5329, 85.9743, 88.498, 91.71, 94.119, 97.1015, 99.9693, 103.5255, 106.2786, 109.3758, 112.2437, 115.1115, 117.9793, 121.1913, 123.9444, 127.0417, 129.7948, 133.1215, 135.7599, 138.7425, 141.4956, 144.4781, 147.346, 150.5579, 153.5405, 156.523, 159.0467, 162.2587, 165.0118, 167.8796, 170.7475, 173.9595, 176.5979, 179.9245, 182.7924, 185.8896, 188.528, 191.5106, 194.0343, 197.0168, 199.8847, 202.8672, 205.6203, 208.3735, 211.1266, 214.4533, 217.3211, 220.5331, 224.0892]
[6.4048, 9.7258, 12.6673, 15.4189, 18.4553, 21.0172, 23.9587, 26.4257, 29.6518, 32.3086, 35.5347, 38.0967, 40.9432, 43.6, 46.4466, 49.1034, 51.8551, 54.3221, 57.3585, 59.8255, 62.9568, 65.6136, 69.0295, 71.6863, 74.6277, 77.3794, 80.5106, 82.9777, 85.9191, 88.6708, 91.5174, 94.0793, 96.831, 99.0134, 101.86, 104.327, 106.8889, 109.4508, 112.5821, 115.0491, 118.2752, 120.932, 123.8735, 126.5303, 129.4717, 132.0337, 134.5956, 136.9677, 139.4347, 141.9967, 144.6535, 147.1205, 149.9671, 152.529, 155.1858, 157.6528, 160.2147, 162.7767, 165.7181, 168.4698, 171.2215, 173.8783, 176.4402, 178.9073, 181.5641, 184.0311]
[6.8444, 9.08, 11.6468, 13.7996, 16.2009, 18.4365, 21.9141, 24.3981, 27.6273, 29.9458, 33.0922, 35.245, 38.557, 41.041, 44.4359, 46.7543, 49.1555, 51.5567, 54.1235, 57.0216, 61.3272, 63.9768, 66.8748, 69.1932, 72.3397, 74.4925, 77.4733, 79.4605, 82.1101, 84.0146, 86.4986, 88.4858, 91.1354, 92.957, 95.6894, 97.5111, 99.9951, 102.1479, 104.4663, 106.6191, 109.1031, 111.1732, 113.6572, 115.6444, 118.2112, 120.1984, 122.848, 124.9181, 127.1537, 129.3893, 131.8733, 134.1089, 136.4273, 138.5802, 141.2298, 143.7966, 146.2806, 148.4334, 151.2486, 153.4015, 156.2167, 158.7007]
[5.1126, 7.2252, 9.5068, 11.6195, 13.6476, 15.3377, 17.1123, 18.7179, 20.577, 22.4362, 24.4643, 26.5769, 29.0276, 31.1402, 33.2528, 35.281, 37.2246, 39.3372, 41.8724, 43.7315, 45.9286, 47.8723, 49.9004, 51.844, 53.9567, 55.9003, 57.8439, 59.872, 62.0692, 63.9283, 65.8719, 67.8155, 69.6746, 71.6183, 73.8154, 76.097, 78.2942, 80.4068, 82.6885, 84.5476, 86.4912, 88.7728, 90.97, 93.0826, 95.5333, 97.6459, 100.0966, 101.7867, 104.1528, 106.519, 108.3781, 110.1527, 112.6879, 114.885, 116.8286, 119.1103, 121.2229, 123.251, 125.1946, 127.3073, 129.2509, 131.11, 133.2226, 135.4198, 137.6169, 139.5605, 141.8422, 144.1238, 146.152, 148.4336, 150.4617, 152.8279, 154.7715, 156.8841, 158.8278, 160.6869]
[11.7596, 13.9365, 16.0524, 18.1072, 19.8365, 21.4845, 23.3562, 25.0652, 26.937, 28.5442, 30.3753, 32.0029, 33.956, 35.5225, 37.4553, 39.3271]
[6.1153, 7.8293, 9.2819, 10.7925, 12.3613, 13.9301, 15.3826, 16.9805, 18.5492, 20.118, 21.7739, 23.1103, 24.8533, 26.5093, 28.1361, 29.7049, 31.3027, 32.8715, 34.5565, 36.1833, 37.7521, 39.2337, 40.8606, 42.5165, 44.0853, 45.625, 47.1647, 48.6463, 50.2441, 51.8419]
[4.8416, 7.0346, 8.6204, 10.5435, 11.8256, 13.5463, 14.8621, 16.7515, 18.0336, 19.7206, 21.4075, 23.2632, 24.6465, 26.4684, 27.9529, 29.7411, 31.3269, 33.25, 34.7345, 36.5564, 38.2771, 40.2678, 41.8198, 43.6754, 45.2612, 47.1506, 48.905, 51.0643, 52.5151, 54.2021, 55.4841, 57.2386, 58.8918, 60.7137]
[9.7658, 11.5225, 12.8888, 14.1901, 16.3047, 18.4192, 20.241, 21.5748, 23.0062, 24.2099, 25.381, 26.6172, 27.8534, 29.1547, 30.4559, 31.7247, 33.1561, 34.3923, 35.8562, 37.0274, 38.3612, 39.5648, 40.9312, 42.1999, 43.5012, 44.7699, 46.2338, 48.9014, 53.0004, 54.2692, 55.4078, 56.6114, 57.8151, 58.9212, 60.1899, 61.3285]
% 31
[9.8618, 11.31, 12.8961, 14.9994, 17.0682, 19.0335, 21.0678, 22.8263, 24.6193, 26.3777, 28.1362, 29.7568, 31.7566, 33.3082, 35.446, 37.5148, 39.618, 41.5489, 43.7901, 45.9624, 48.1346, 50.3068, 52.3067, 54.0996, 56.1684, 57.789, 59.7199, 61.4783, 63.3747, 65.0987]
};


